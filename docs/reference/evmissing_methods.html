<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Methods for objects of class "evmissing" — evmissing_methods • evmissing</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Methods for objects of class " evmissing evmissing_methods><meta name="description" content='Methods for objects of class "evmissing" returned from gev_mle.'><meta property="og:description" content='Methods for objects of class "evmissing" returned from gev_mle.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evmissing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/evmissing/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Methods for objects of class <code>"evmissing"</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/evmissing/blob/HEAD/R/methods_evmissing.R"><code>R/methods_evmissing.R</code></a></small>
      <div class="d-none name"><code>evmissing_methods.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Methods for objects of class <code>"evmissing"</code> returned from <code><a href="gev_mle.html">gev_mle</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'summary.evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  profile <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  faster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'evmissing'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  adjust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pp"</span>, <span class="st">"qq"</span>, <span class="st">"return"</span>, <span class="st">"density"</span><span class="op">)</span>,</span>
<span>  m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  profile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">num</span>,</span>
<span>  npy <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object inheriting from class <code>"evmissing"</code>, a result of a
call to <code><a href="gev_mle.html">gev_mle</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments. Only used in the following cases.</p><ul><li><p><code>plot.evmissing</code>: to pass graphical parameters to the graphical functions
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>, <code><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></code>,
<code><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></code>, <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></code>,
<code><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></code> and <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></code>.
In particular, <code>col</code>, <code>lty</code> and <code>lwd</code> may be used to control the colour,
type and width of lines and <code>pch</code> the type of plotting symbol. All data
points are coloured black in all plots, which cannot be changed.</p></li>
<li><p><code>print.summary.evmissing</code>: to pass arguments to <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></code>.</p></li>
</ul></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>An integer. Passed to <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></code> to round the
values in the summary.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object returned by <code>summary.evmissing</code>.</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>A character vector specifying the parameters for which
confidence intervals are to be calculated. The default, <code>which = "all"</code>,
produces confidence intervals for all the parameters, that is,
\(\mu\), \(\sigma\) and \(\xi\). Otherwise, <code>parm</code> must be a subset
of <code>c("mu", "sigma", "xi")</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>The confidence level required.  A numeric scalar in (0, 1).</p></dd>


<dt id="arg-profile">profile<a class="anchor" aria-label="anchor" href="#arg-profile"></a></dt>
<dd><p>A logical scalar. If <code>TRUE</code> then confidence intervals
based on a profile log-likelihood are returned.  If <code>FALSE</code> then intervals
based on approximate large sample normal theory, which are symmetric about
the MLE, are returned.</p></dd>


<dt id="arg-mult">mult<a class="anchor" aria-label="anchor" href="#arg-mult"></a></dt>
<dd><p>A positive numeric scalar. Controls the increment by which the
parameter of interest is increased/decreased when profiling above/below
its MLE. The increment is <code>mult * se / 100</code> where <code>se</code> is the estimated
standard error of the estimator of the parameter. Decreasing <code>mult</code>
profiles at more points but will be slower. The default, <code>mult = 2</code> should
be sufficiently small to produce a smooth looking plot of the profile
log-likelihood using <code><a href="confint_gev_methods.html">plot.confint_gev</a></code>. To estimate the confidence
limits more quickly, the value of <code>mult</code> can be increased and/or the
argument <code>faster</code> set to <code>TRUE</code>.</p></dd>


<dt id="arg-faster">faster<a class="anchor" aria-label="anchor" href="#arg-faster"></a></dt>
<dd><p>A logical scalar. If <code>faster = TRUE</code> then the profiling of the
log-likelihood in search of a lower (upper) confidence limit is started at
the corresponding symmetric lower (upper) confidence limit.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Only relevant if <code>profile = TRUE</code>. A numeric vector of values
that determine the accuracy of the confidence limits. <code>epsilon</code> is
recycled to the length of the parameter vector <code>parm</code>.</p><ul><li><p>If <code>epsilon[i] &gt; 0</code> then this value is passed as the argument <code>epsilon</code>
to the <code><a href="https://github.com/paulnorthrop/itp/reference/itp.html" class="external-link">itp::itp</a></code> function, which estimates the parameter values for
which the profile log-likelihood for parameter <code>i</code> drops to the value
that defines the confidence limits, once profiling has been successful
in finding an interval within which this value lies.</p></li>
<li><p>If <code>epsilon[i] &lt; 0</code> quadratic interpolation is used, which will tend to
be faster.</p></li>
<li><p>If <code>epsilon[i] = 0</code> then linear interpolation is used, which will be
faster still.</p></li>
</ul></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>If <code>adjust = TRUE</code> then the diagnostic plots produced by
<code>plot.evmissing</code> are adjusted for the number of non-missing observations
contributing to each block maximum. Otherwise, no adjustment is made.</p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>If supplied, this must either be a character scalar, one of
<code>"pp"</code>, <code>"qq"</code>, <code>"return"</code> or <code>"density"</code> or a numeric scalar in <code>1:4</code>,
with <code>1</code> corresponding to <code>"pp"</code> etc. If <code>which</code> is missing then all four
plots are produced in a 2 by 2 display.</p></dd>


<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>A numeric vector of return periods to label on the
horizontal axis of the <strong>return level plot</strong>. Along with the data, the
smallest and largest return period values in <code>m</code> influence the range of
return periods for which return level estimates are plotted. All values in
<code>m</code> must be greater than 1.</p></dd>


<dt id="arg-num">num<a class="anchor" aria-label="anchor" href="#arg-num"></a></dt>
<dd><p>An integer scalar. The number of return level estimates to
calculate to produce the return level curve and pointwise confidence
limits in the <strong>return level plot</strong>. The default setting is approximately
5 times <code>log(max(m), base = 10)</code>. If <code>profile = TRUE</code> then reducing <code>num</code>
will speed up the calculation of the confidence limits, at the expense of
a reduction in smoothness of the curves.</p></dd>


<dt id="arg-npy">npy<a class="anchor" aria-label="anchor" href="#arg-npy"></a></dt>
<dd><p>A numeric scalar.  The number \(n_{py}\) of block maxima per
year. If the blocks are of length 1 year then <code>npy = 1</code>. This is only
used in the <strong>return level plot</strong>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>coef.evmissing</code>: a numeric vector of length 3 with names
<code>c("mu", "sigma", "xi")</code>.  The MLEs of the parameters \(\mu\),
\(\sigma\) and \(\xi\).</p>
<p><code>vcov.evmissing</code>: a \(3 \times 3\) matrix with row and column
names <code>c("mu", "sigma", "xi")</code>. The estimated variance-covariance matrix
for the model parameters \(\mu\), \(\sigma\) and \(\xi\).</p>
<p><code>nobs.evmissing</code>: a numeric scalar. The number of maxima used in the model
fit.</p>
<p><code>logLik.evmissing</code>: an object of class <code>"logLik"</code>: a numeric scalar
with value equal to the maximised log-likelihood. The returned object
also has attributes <code>nobs</code>, the number of maxima used in the model fit
and <code>"df"</code> (degrees of freedom), which is equal to the number of total
number of parameters estimated (3).</p>
<p><code>summary.evmissing</code>: an object with class <code>"summary.evmissing"</code> containing
the original function call and a matrix of estimates and estimated
standard errors with row names <code>c("mu", "sigma", "xi")</code>.  The object is
printed by <code>print.summary.evmissing</code>.</p>
<p><code>print.summary.evmissing</code>: the argument <code>x</code> is returned, invisibly.</p>
<p><code>confint.evmissing</code>: an object of class <code>c("confint_gev", "evmissing")</code>.
A numeric matrix with 2 columns giving the lower and upper confidence
limits for each parameter. These columns are labelled as <code>(1-level)/2</code> and
<code>1-(1-level)/2</code>, expressed as a percentage, by default <code>2.5%</code> and <code>97.5%</code>.
The row names are the names of the parameters supplied in <code>parm</code>.
The ordering <code>"mu"</code>, <code>"sigma"</code>, <code>"xi"</code> is retained regardless of the
ordering of the parameters in <code>parm</code>.
If <code>profile = TRUE</code> then the returned object has extra attributes <code>crit</code>,
<code>level</code> and <code>for_plot</code>. The latter is a named list of length 3 with
components <code>mu</code>, <code>sigma</code> and <code>xi</code>. Each components is a 2-column numeric
matrix. The first column (named <code>mu_values</code> etc) contains values of the
parameter and the second column the corresponding values of the profile
log-likelihood. The profile log-likelihood is equal to the attribute
<code>crit</code> at the limits of the confidence interval. The attribute <code>level</code> is
the input argument <code>level</code>.</p>
<p><code>plot.evmissing</code>: if a return level plot has been requested, a 3-column
matrix containing the values plotted in the return level plot. Column 2
contains the estimated return levels and columns 1 and 3 the lower and
upper confidence limits.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The plots produced by <code>plot.evmissing</code> are of a similar form to the
visual diagnostics is the <code>ismev</code> package and described in Coles (2001),
that is, a probability plot (<code>which = "pp"</code> or <code>which = 1</code>), a quantile
plot (<code>which ="qq"</code> of <code>which = 2</code>), a return level plot
(<code>which = "return"</code> or <code>which = 3</code>) and a histogram of block maxima with a
fitted GEV density superimposed (<code>which = "density"</code> or <code>which = 4</code>).
Pointwise confidence bands of level <code>level</code> are added to the probability
plot and quantile plot.</p>
<p>The default setting for confidence intervals for a return level plot
produced by <code>plot.evmissing</code> is <code>profile = TRUE</code>, which uses <code><a href="gev_return.html">gev_return</a></code>
and <code><a href="return_level_methods.html">confint.return_level</a></code>. The plot takes longer to produce, but it
avoids the unrealistic feature of the lower confidence limits decreasing
as we extrapolate to long return periods.</p>
<p>If <code>adjust = TRUE</code> then the empirical values based on the observed block
maxima are adjusted for the number of non-missing raw observations in
each block based on the fitted GEV parameter values for reduced block
sizes. Passing <code>adjust = FALSE</code> is not sensible, but, if there are missing
data, then it can serve to show that making the adjustment is necessary to
give the correct impression of how well the model has fitted the data.</p>
<p>For <code>confint.evmissing</code>, the default, <code>epsilon = -1</code>, should work well
enough in most circumstances, but to achieve a specific accuracy set
<code>epsilon</code> to be a small positive value, for example, <code>epsilon = 1e-4</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
Modeling of Extreme Values</em>, Springer-Verlag, London.
<a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">doi:10.1007/978-1-4471-3675-0_3</a></p>
<p>Heffernan, J. E. and Stephenson, A. G. (2018). <em>ismev: An
Introduction to Statistical Modeling of Extreme Values</em>. R package version
1.42. <a href="https://doi.org/10.32614/CRAN.package.ismev" class="external-link">doi:10.32614/CRAN.package.ismev</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gev_mle.html">gev_mle</a></code> and <code><a href="confint_gev_methods.html">confint_gev_methods</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Plymouth ozone data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make adjustment for the numbers of non-missing values per block</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="gev_mle.html">gev_mle</a></span><span class="op">(</span><span class="va">PlymouthOzoneMaxima</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mu        sigma           xi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.287713e+02 1.880807e+01 1.099327e-03 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               mu      sigma          xi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    19.3747981 4.20796047 -0.29507393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma  4.2079605 6.94147798  0.01825292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xi    -0.2950739 0.01825292  0.02512590</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 27</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -120.5328 (df=3)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gev_mle(data = PlymouthOzoneMaxima)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    1.288e+02     4.4020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma 1.881e+01     2.6350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xi    1.099e-03     0.1585</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model diagnostic plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When profile = FALSE the return confidence limits are unrealistic</span></span></span>
<span class="r-in"><span><span class="co"># for long return periods</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, profile <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evmissing_methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create the return level plot only</span></span></span>
<span class="r-in"><span><span class="co"># When profile = TRUE (the default) the confidence limits are fine</span></span></span>
<span class="r-in"><span><span class="co"># but the plot takes longer</span></span></span>
<span class="r-in"><span><span class="co"># For speed, we reduce the number, num, of points used to plot the curves</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">3</span>, num <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evmissing_methods-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If we do not reflect the adjustment in the plot then it gives a false</span></span></span>
<span class="r-in"><span><span class="co"># impression of how well the model has fitted the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, adjust <span class="op">=</span> <span class="cn">FALSE</span>, profile <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evmissing_methods-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Confidence intervals</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Confidence limits that are symmetric about the respective MLEs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              2.5%       97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    120.1441804 137.3984539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma  13.6442183  23.9719290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xi     -0.3095775   0.3117762</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calling confint to produce a smooth profile log-likelihood plot</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, profile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              2.5%       97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    120.3550195 137.9594426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma  14.5976855  25.5383429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xi     -0.3237415   0.3159855</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, parm <span class="op">=</span> <span class="st">"xi"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evmissing_methods-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Doing this more quickly when we only want the approximate confidence limits</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, mult <span class="op">=</span> <span class="fl">32</span>, faster <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              2.5%       97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu    120.3574766 137.9594215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma  14.8182568  25.5383840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xi     -0.3229961   0.3158122</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, parm <span class="op">=</span> <span class="st">"xi"</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evmissing_methods-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Emma S. Simpson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

