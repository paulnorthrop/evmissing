<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extreme Value Analyses with Missing Data • evmissing</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Extreme Value Analyses with Missing Data">
<meta name="description" content="Performs likelihood-based extreme value inferences with adjustment for the presence of missing values based on Simpson and Northrop (2026). A Generalised Extreme Value distribution is fitted to block maxima using maximum likelihood estimation, with the location and scale parameters reflecting the numbers of non-missing raw values in each block. A Bayesian version is also provided. For the purposes of comparison, there are options to make no adjustment for missing values or to discard any block maximum for which greater than a percentage of the underlying raw values are missing. Example datasets containing missing values are provided.">
<meta property="og:description" content="Performs likelihood-based extreme value inferences with adjustment for the presence of missing values based on Simpson and Northrop (2026). A Generalised Extreme Value distribution is fitted to block maxima using maximum likelihood estimation, with the location and scale parameters reflecting the numbers of non-missing raw values in each block. A Bayesian version is also provided. For the purposes of comparison, there are options to make no adjustment for missing values or to discard any block maximum for which greater than a percentage of the underlying raw values are missing. Example datasets containing missing values are provided.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">evmissing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/evmissing/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="evmissing-">evmissing <a href="https://paulnorthrop.github.io/evmissing/" class="external-link"><img src="reference/figures/evmissing_logo.png" align="right" style="float:right; height:150px;" alt="evmissing logo"></a>
<a class="anchor" aria-label="anchor" href="#evmissing-"></a>
</h1></div>
<p><a href="https://github.com/paulnorthrop/evmissing/actions/workflows/R-CMD-check.yaml"><img src="https://github.com/paulnorthrop/evmissing/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/github/paulnorthrop/evmissing?branch=master" class="external-link"><img src="https://codecov.io/github/paulnorthrop/evmissing/coverage.svg?branch=master" alt="Coverage Status"></a> <a href="https://cran.r-project.org/package=evmissing" class="external-link"><img src="https://www.r-pkg.org/badges/version/evmissing" alt="CRAN_Status_Badge"></a> <a href="https://cran.r-project.org/package=evmissing" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/evmissing?color=brightgreen" alt="Downloads (monthly)"></a> <a href="https://cran.r-project.org/package=evmissing" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/evmissing?color=brightgreen" alt="Downloads (total)"></a></p>
<div class="section level2">
<h2 id="extreme-value-analyses-with-missing-data">Extreme Value Analyses with Missing Data<a class="anchor" aria-label="anchor" href="#extreme-value-analyses-with-missing-data"></a>
</h2>
<p>Performs likelihood-based extreme value inferences with adjustment for the presence of missing values. A GEV distribution is fitted to block maxima using maximum likelihood estimation, with the GEV location and scale parameter reflecting the numbers of non-missing raw values in each block. A Bayesian version is also provided. For the purposes of comparison, there are options to make no adjustment for missing values or to discard any block maximum for which greater than a percentage of the underlying raw values are missing. A plot method provides a set of standard model diagnostic plots, with appropriate adjustment made for the presence of missing values. Example datasets containing missing values are provided.</p>
<p>The <code>evmissing</code> package was created to accompany Simpson and Northrop (2026), which will appear in <a href="https://onlinelibrary.wiley.com/loi/1099095x/year/2026" class="external-link">Environmetrics in 2026</a>.</p>
</div>
<div class="section level2">
<h2 id="an-example">An example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h2>
<p>The main function in <code>evmissing</code> is <code><a href="reference/gev_mle.html">gev_mle()</a></code>, which fits a GEV distribution to block maxima using maximum likelihood estimation, with the option to make an adjustment for the numbers of non-missing raw values in each block.</p>
<p>Our adjustment is based on the strong assumption that missing values occur completely at random. We suppose that a block maximum <span class="math inline">\(M_n\)</span> based on a full block of length <span class="math inline">\(n\)</span> has a GEV(<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\xi\)</span>) distribution, with distribution function <span class="math inline">\(G(x)\)</span>. Let <span class="math inline">\(n_i\)</span> be the number of non-missing values in block <span class="math inline">\(i\)</span> and let <span class="math inline">\(M_{n_i}\)</span> denote the block maximum of such a block. We suppose that <span class="math inline">\(M_{n_i}\)</span> has a GEV(<span class="math inline">\(\mu(n_i)\)</span>, <span class="math inline">\(\sigma(n_i)\)</span>, <span class="math inline">\(\xi\)</span>) distribution, where <span class="math inline">\(\mu(n_i) = \mu + \sigma [(n_i/n)^\xi -1] / \xi\)</span> and <span class="math inline">\(\sigma(n_i) = \sigma (n_i/n)^\xi\)</span>. These expressions are based on the supposition that <span class="math inline">\(M_{n_i}\)</span> has a distribution function of <span class="math inline">\(G(x)^{n_i/n}\)</span>, where <span class="math inline">\(n_i/n\)</span> reflects the effective block size for block <span class="math inline">\(i\)</span> relative to the full block size.</p>
<div class="section level3">
<h3 id="sea-surge-height-data">Sea surge height data<a class="anchor" aria-label="anchor" href="#sea-surge-height-data"></a>
</h3>
<p>We illustrate this using the data <code>BrestSurgeMaxima</code>, which is a data frame containing annual maximum sea surge heights (in cm) at Brest, France for the years 1846-2007 inclusive.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/evmissing/" class="external-link">evmissing</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BrestSurgeMaxima</span><span class="op">)</span></span>
<span><span class="co">#&gt;      maxima notNA   n block</span></span>
<span><span class="co">#&gt; 1846 59.987   361 365     1</span></span>
<span><span class="co">#&gt; 1847 58.873   344 365     2</span></span>
<span><span class="co">#&gt; 1848 59.749   366 366     3</span></span>
<span><span class="co">#&gt; 1849 49.547   365 365     4</span></span>
<span><span class="co">#&gt; 1850 55.512   365 365     5</span></span>
<span><span class="co">#&gt; 1851 69.422   365 365     6</span></span></code></pre></div>
<p>In addition to the annual maxima this data frame includes <code>notNA</code>, the number of days in each year for which raw data were available, and <code>n</code>, the number of days in the year, that is, the block length. The function <code><a href="reference/block_maxima.html">block_maxima()</a></code> can be used to create data of this format from a raw time series and information about how blocks are defined. Alternatively, we can provide a raw time series directly to <code><a href="reference/gev_mle.html">gev_mle()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make the adjustment</span></span>
<span><span class="va">fit_adjust</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gev_mle.html">gev_mle</a></span><span class="op">(</span><span class="va">BrestSurgeMaxima</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_adjust</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; gev_mle(data = BrestSurgeMaxima)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Estimate Std. Error</span></span>
<span><span class="co">#&gt; mu    52.89000     1.0650</span></span>
<span><span class="co">#&gt; sigma 11.84000     0.7361</span></span>
<span><span class="co">#&gt; xi    -0.02375     0.0445</span></span>
<span></span>
<span><span class="co"># Make no adjustment</span></span>
<span><span class="va">fit_no_adjust</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gev_mle.html">gev_mle</a></span><span class="op">(</span><span class="va">BrestSurgeMaxima</span>, adjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_no_adjust</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; gev_mle(data = BrestSurgeMaxima, adjust = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Estimate Std. Error</span></span>
<span><span class="co">#&gt; mu    52.27000    1.07300</span></span>
<span><span class="co">#&gt; sigma 12.09000    0.76170</span></span>
<span><span class="co">#&gt; xi    -0.03005    0.04388</span></span></code></pre></div>
<p>The most obvious difference between these model fits is that the estimated location parameter with adjustment (52.27 cm) is smaller than that when the adjustment is used (52.89 cm). This is as expected because if some of the data that could contribute to an annual maximum are missing then the observed annual maximum is stochastically smaller than the unobserved maximum based on full data.</p>
<p>Alternatively, if the argument <code>adjust</code> to <code><a href="reference/gev_mle.html">gev_mle()</a></code> is a numeric scalar then any block maximum for which greater than <code>adjust</code> percent of the underlying raw values are missing is discarded before fitting a GEV distribution, with no further adjustment made.</p>
</div>
<div class="section level3">
<h3 id="model-diagnostic-plots">Model diagnostic plots<a class="anchor" aria-label="anchor" href="#model-diagnostic-plots"></a>
</h3>
<p>The plot method for an object returned from <code>gev_mle</code> creates visual model diagnostics like those described in Coles (2001) and implemented in Heffernan and Stephenson (2018), where the values plotted have been adjusted, where necessary, for the presence of missing values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_adjust</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/README-plots-1.png" alt="Diagnostic plots of for the Brest Sea Surge Maxima data. PP, QQ, return level and density plots." width="60%" style="display: block; margin: auto;"></p>
<p>We see that overall the GEV model fits these data well, although the largest annual maximum sea surge height lies outside the profile-based 95% confidence interval that is relevant to this observation.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the current released version from CRAN:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"evmissing"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Coles2001" class="csl-entry">
Coles, Stuart G. 2001. <em>An Introduction to Statistical Modeling of Extreme Values</em>. London: Springer. <a href="https://doi.org/10.1007/978-1-4471-3675-0" class="external-link uri">https://doi.org/10.1007/978-1-4471-3675-0</a>.
</div>
<div id="ref-ismev" class="csl-entry">
Heffernan, Janet E., and Alec G. Stephenson. 2018. <em><span class="nocase">i</span>smev: An Introduction to Statistical Modeling of Extreme Values</em>. <a href="https://doi.org/10.32614/CRAN.package.ismev" class="external-link uri">https://doi.org/10.32614/CRAN.package.ismev</a>.
</div>
<div id="ref-SimpsonNorthrop2026" class="csl-entry">
Simpson, Emma S., and Paul J. Northrop. 2026. “Accounting for Missing Data When Modelling Block Maxima.” <em>Environmetrics (To Appear)</em>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=evmissing" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/paulnorthrop/evmissing/">Browse source code</a></li>
<li><a href="https://github.com/paulnorthrop/evmissing/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing evmissing</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Paul J. Northrop <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
<li>Emma S. Simpson <br><small class="roles"> Author, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Emma S. Simpson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
